<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ìŠ¤ì¿ ë²„ ë‹¤ì´ë¹™ ê³„ì‚°ê¸°</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f5f7fa; padding-top: 40px; }
    .tab-content { margin-top: 20px; }
    input.form-control:focus { box-shadow: 0 0 5px #3498db; }
    .yellow { background-color: #ffffcc !important; }
    pre { background: #eef6fb; padding: 15px; border-radius: 6px; white-space: pre-wrap; }
  </style>
</head>
<body>

<div class="container">
  <h2 class="text-center mb-4">ğŸŒŠ ìŠ¤ì¿ ë²„ ë‹¤ì´ë¹™ ê³„ì‚°ê¸°</h2>

  <!-- ğŸ”¹ íƒ­ ë©”ë‰´ -->
  <ul class="nav nav-tabs" id="calcTabs">
    <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#rmv">RMV</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#nitrox">ë‚˜ì´íŠ¸ë¡ìŠ¤</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#trimix">íŠ¸ë¼ì´ë¯¹ìŠ¤</a></li>
  </ul>

  <div class="tab-content">

    <!-- âœ… RMV ê³„ì‚°ê¸° -->
    <!-- ğŸ”§ ì—¬ê¸°ë¶€í„° RMV ê³„ì‚°ê¸° HTML ì‹œì‘ -->
    <div class="tab-pane fade show active" id="rmv">
      <div class="mt-4">
        <label>ì‚¬ìš©í•œ ê³µê¸°ëŸ‰ (L):</label>
        <input type="number" class="form-control yellow" id="usedAir">
        <label>í‰ê·  ìˆ˜ì‹¬ (m):</label>
        <input type="number" class="form-control yellow" id="avgDepth">
        <label>ë‹¤ì´ë¹™ ì‹œê°„ (ë¶„):</label>
        <input type="number" class="form-control yellow" id="diveTime">
        <button class="btn btn-primary mt-3 w-100" onclick="calculateRMV()">ê³„ì‚°í•˜ê¸°</button>
        <pre id="rmvResult"></pre>
      </div>
    </div>
    <!-- ğŸ”§ ì—¬ê¸°ê¹Œì§€ RMV ê³„ì‚°ê¸° HTML ë -->

    <!-- âœ… ë‚˜ì´íŠ¸ë¡ìŠ¤ ë¸”ë Œë”© ê³„ì‚°ê¸° -->
    <!-- ğŸ”§ ì—¬ê¸°ë¶€í„° ë‚˜ì´íŠ¸ë¡ìŠ¤ ê³„ì‚°ê¸° HTML ì‹œì‘ -->
    <div class="tab-pane fade" id="nitrox">
      <div class="mt-4">
        <label>ëª©í‘œ Oâ‚‚ (%):</label>
        <input type="number" class="form-control yellow" id="targetO2">
        <label>ì´ ì••ë ¥ (bar):</label>
        <input type="number" class="form-control yellow" id="totalPressure">
        <button class="btn btn-success mt-3 w-100" onclick="calculateNitrox()">ê³„ì‚°í•˜ê¸°</button>
        <pre id="nitroxResult"></pre>
      </div>
    </div>
    <!-- ğŸ”§ ì—¬ê¸°ê¹Œì§€ ë‚˜ì´íŠ¸ë¡ìŠ¤ ê³„ì‚°ê¸° HTML ë -->

    <!-- âœ… íŠ¸ë¼ì´ë¯¹ìŠ¤ ë¸”ë Œë”© ê³„ì‚°ê¸° -->
    <!-- ğŸ”§ ì—¬ê¸°ë¶€í„° íŠ¸ë¼ì´ë¯¹ìŠ¤ ê³„ì‚°ê¸° HTML ì‹œì‘ -->
    <div class="tab-pane fade" id="trimix">
      <div class="mt-4">
        <label>ëª©í‘œ ìˆ˜ì‹¬ (m):</label>
        <input type="number" class="form-control yellow" id="depth">
        <label>ëª©í‘œ END (m):</label>
        <input type="number" class="form-control yellow" id="end">
        <label>ì´ ì¶©ì „ ì••ë ¥ (bar):</label>
        <input type="number" class="form-control yellow" id="fill">
        <button class="btn btn-danger mt-3 w-100" onclick="calculateTrimix()">ê³„ì‚°í•˜ê¸°</button>
        <pre id="trimixResult"></pre>
      </div>
    </div>
    <!-- ğŸ”§ ì—¬ê¸°ê¹Œì§€ íŠ¸ë¼ì´ë¯¹ìŠ¤ ê³„ì‚°ê¸° HTML ë -->

  </div>
</div>

<!-- âœ… ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // ğŸ”§ ì—¬ê¸°ë¶€í„° RMV ê³„ì‚°ê¸° í•¨ìˆ˜
  function calculateRMV() {
    const usedAir = parseFloat(document.getElementById("usedAir").value);
    const avgDepth = parseFloat(document.getElementById("avgDepth").value);
    const diveTime = parseFloat(document.getElementById("diveTime").value);
    if (isNaN(usedAir) || isNaN(avgDepth) || isNaN(diveTime) || diveTime <= 0) {
      document.getElementById("rmvResult").innerText = "ëª¨ë“  ê°’ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.";
      return;
    }
    const ata = avgDepth / 10 + 1;
    const rmv = usedAir / (ata * diveTime);
    document.getElementById("rmvResult").innerText = `RMV = ${rmv.toFixed(1)} L/min`;
  }
  // ğŸ”§ ì—¬ê¸°ê¹Œì§€ RMV ê³„ì‚°ê¸° í•¨ìˆ˜

  // ğŸ”§ ì—¬ê¸°ë¶€í„° ë‚˜ì´íŠ¸ë¡ìŠ¤ ê³„ì‚°ê¸° í•¨ìˆ˜
  function calculateNitrox() {
    const o2 = parseFloat(document.getElementById("targetO2").value);
    const total = parseFloat(document.getElementById("totalPressure").value);
    if (isNaN(o2) || isNaN(total)) {
      document.getElementById("nitroxResult").innerText = "ê°’ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.";
      return;
    }
    const rawO2 = (o2 - 21) / 79 * total;
    const rounded = Math.round(rawO2);
    const adjusted = rounded - 1;
    const air = total - adjusted;
    document.getElementById("nitroxResult").innerText =
      `100% ì‚°ì†Œ: ${adjusted} bar (ê³„ì‚°ê°’ ${rounded} bar ì—ì„œ -1 bar ì ìš©)\nê³µê¸°: ${air} bar (ì´ ${total} bar ê¸°ì¤€)`;
  }
  // ğŸ”§ ì—¬ê¸°ê¹Œì§€ ë‚˜ì´íŠ¸ë¡ìŠ¤ ê³„ì‚°ê¸° í•¨ìˆ˜

  // ğŸ”§ ì—¬ê¸°ë¶€í„° íŠ¸ë¼ì´ë¯¹ìŠ¤ ê³„ì‚°ê¸° í•¨ìˆ˜
  function calculateTrimix() {
    const depth = parseFloat(document.getElementById("depth").value);
    const end = parseFloat(document.getElementById("end").value);
    const fill = parseFloat(document.getElementById("fill").value);
    if (isNaN(depth) || isNaN(end) || isNaN(fill) || fill <= 0 || depth <= 0 || end < 0 || end >= depth) {
      document.getElementById("trimixResult").innerText = "ì…ë ¥ì„ í™•ì¸í•´ì£¼ì„¸ìš”.";
      return;
    }

    const ata = depth / 10 + 1;
    const o2frac = 1.4 / ata;
    const he_raw = 1 - ((end + 10) / (depth + 10));
    const he_frac = Math.ceil((he_raw * 100) / 5) * 5 / 100;
    const eanx = o2frac / (1 - he_frac);

    const he_bar = fill * he_frac;
    const o2_bar = ((eanx - 0.21) / 0.79) * (fill - he_bar);
    const air_bar = fill - he_bar - o2_bar;

    const cum1 = o2_bar;
    const cum2 = o2_bar + he_bar;

    document.getElementById("trimixResult").innerText =
`ëª©í‘œ ìˆ˜ì‹¬: ${depth}m / ëª©í‘œ END: ${end}m
â†’ íŠ¸ë¼ì´ë¯¹ìŠ¤: Oâ‚‚ ${(o2frac * 100).toFixed(1)}% / He ${(he_frac * 100).toFixed(0)}% (TX ${Math.round(o2frac * 100)} / ${Math.round(he_frac * 100)})

EAN_x = ${eanx.toFixed(3)}  
(EAN_x = He ì œì™¸ í›„ Oâ‚‚ì˜ ë¹„ìœ¨ = Oâ‚‚% Ã· (1 - He%))

ì´ ì¶©ì „ ì••ë ¥: ${fill} bar
- Oâ‚‚ ì£¼ì…ì••ë ¥: ${o2_bar.toFixed(1)} bar â†’ ëˆ„ì  ${cum1.toFixed(1)} bar
- He ì£¼ì…ì••ë ¥: ${he_bar.toFixed(1)} bar â†’ ëˆ„ì  ${cum2.toFixed(1)} bar
- Air ì£¼ì…ì••ë ¥: ${air_bar.toFixed(1)} bar â†’ ëˆ„ì  ${fill.toFixed(1)} bar`;
  }
  // ğŸ”§ ì—¬ê¸°ê¹Œì§€ íŠ¸ë¼ì´ë¯¹ìŠ¤ ê³„ì‚°ê¸° í•¨ìˆ˜
</script>

</body>
</html>
